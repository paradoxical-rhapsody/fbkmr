% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/K.fit_BKMR_wasp.R
\name{skmbayes}
\alias{skmbayes}
\title{Fit scalable Bayesian kernel machine regression}
\usage{
skmbayes(
  Z,
  X,
  y,
  n_subset = 1,
  n_samp = 200,
  iter = 1000,
  varsel = FALSE,
  est.h = TRUE,
  Znew = NULL,
  file_path = NULL,
  save_loc = FALSE,
  linprog = TRUE,
  ...
)
}
\arguments{
\item{Z}{an \code{n}-by-\code{M} matrix of predictor variables to be included in the \code{h} function. Each row represents an observation and each column represents an predictor.}

\item{X}{an \code{n}-by-\code{K} matrix of covariate data where each row represents an observation and each column represents a covariate. Should not contain an intercept column.}

\item{y}{a vector of outcome data of length \code{n}.}

\item{n_subset}{number of subsets to split the data}

\item{n_samp}{number of samples drew from final MCMC}

\item{iter}{number of iterations to run the sampler}

\item{varsel}{TRUE or FALSE: indicator for whether to conduct variable selection on the Z variables in \code{h}}

\item{est.h}{TRUE or FALSE: indicator for whether to sample from the posterior distribution of the subject-specific effects h_i within the main sampler. This will slow down the model fitting.}

\item{Znew}{optional matrix of new predictor values at which to predict \code{h}, where each row represents a new observation. This will slow down the model fitting, and can be done as a post-processing step using \code{\link{SamplePred}}}

\item{file_path}{working directory for saving the resulting rds files.}

\item{save_loc}{TRUE or FALSE indicator for whether to save intemediate or final result on local machine.}

\item{linprog}{TRUE or FALSE: flag indicating whether to preform linear programming for combining samples from subset MCMC results.}

\item{family}{a description of the error distribution and link function to be used in the model. Currently implemented for \code{gaussian} and \code{binomial} families.}

\item{id}{optional vector (of length \code{n}) of grouping factors for fitting a model with a random intercept. If NULL then no random intercept will be included.}

\item{verbose}{TRUE or FALSE: flag indicating whether to print intermediate diagnostic information during the model fitting.}

\item{starting.values}{list of starting values for each parameter. If not specified default values will be chosen.}

\item{control.params}{list of parameters specifying the prior distributions and tuning parameters for the MCMC algorithm. If not specified default values will be chosen.}

\item{groups}{optional vector (of length \code{M}) of group indictors for fitting hierarchical variable selection if varsel=TRUE. If varsel=TRUE without group specification, component-wise variable selections will be performed.}

\item{knots}{optional matrix of knot locations for implementing the Gaussian predictive process of Banerjee et al (2008). Currently only implemented for models without a random intercept.}

\item{ztest}{optional vector indicating on which variables in Z to conduct variable selection (the remaining variables will be forced into the model).}

\item{rmethod}{for those predictors being forced into the \code{h} function, the method for sampling the \code{r[m]} values. Takes the value of 'varying' to allow separate \code{r[m]} for each predictor; 'equal' to force the same \code{r[m]} for each predictor; or 'fixed' to fix the \code{r[m]} to their starting values}
}
\value{
an object of class "bkmrfit", which has the associated methods:
\itemize{
  \item \code{\link{print}} (i.e., \code{\link{print.bkmrfit}})
  \item \code{\link{summary}} (i.e., \code{\link{summary.bkmrfit}})
}
}
\description{
Fits the Bayesian kernel machine regression (BKMR) model using Markov chain Monte Carlo (MCMC) methods with divide-and-conquer technique.
}
\examples{
## First generate dataset
set.seed(111)
dat <- SimData(n = 1000, M = 4)
y <- dat$y
Z <- dat$Z
X <- dat$X

## Fit model with 5 subsests
set.seed(111)
fitkm <- skmbayes(y = y, Z = Z, X = X, iter = 1000, n_subset=5, verbose = FALSE, varsel = FALSE)

}
